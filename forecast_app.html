<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>App | S.O.R.F.</title>
    <link rel="icon" type="image/x-icon" href="/images/favicon.png" />
    <link rel="stylesheet" href="mystyle.css" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""
    />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-omnivore/v0.3.1/leaflet-omnivore.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <style>
            .right-section {
              text-align: left;
            }
            table,
            th,
            td {
              border-style: solid;
              border-collapse: collapse;
              padding: 10px;
            }
            th {
              text-align: center;
            }
            /*Map-form container*/
            .map-form-container {
              display: flex;
              flex-direction: row;
              align-items: flex-start;
              gap: 5px;
            }
            #map {
              height: 350px;
              width: 60%;
            }
      #forecast_input {
        flex: 1;
        padding-left: 20px;
        padding-right: 20px;
        background-color: #6b8b8c;
        border-radius: 8px;
        width: 20%;
        height: 360px;

      }

      /*Graph-table container*/
      .graph-table-container {
              display: flex;
              flex-direction: row;
              align-items: flex-start;
              gap: 5px;
            }
      #forecast_table {
        flex: 1;
        width: 20%;
      }
      #graph_container {
        flex: 1;
        width: auto;
      }


      /*Special button formatting*/
      button.button {
        background-color: #2e5b29;
      }
      button.button:hover {
        background-color: #016FB9 ; /*Blue on hover*/
        transform: translateY(0px);
      }

      @media (max-width: 768px) {
        .map-form-container {
          flex-direction: column; /* Stack elements on smaller screens */
          align-items: center;
        }

        #map,
        #forecast_input {
          width: auto; /* Full width on small screens */
        }
    </style>
  </head>
  <body>
    <div class="left-section">
      <img
        class="special-image"
        src="https://raw.githubusercontent.com/nathang425/nathang425.github.io/refs/heads/main/images/20230912_080630.jpg"
        alt="Me"
        width="50%"
        height="50%"
      />
      <br />
      <header>
        <h1>Nate Godfrey</h1>
      </header>
      <a class="button" href="https://nathang425.github.io/">Home</a>
      <a class="button" href="https://nathang425.github.io/ce514">514 Page</a>
      <p>
        Welcome to my personal website. I'm an engineering student at BYU,
        graduating in April 2025. This site and most of its pages were created
        for the CE514 course at Brigham Young University, taught by Dr. Dan
        Ames.
      </p>
      <footer>
        Photo by
        <a
          href="https://unsplash.com/@averycocozziello?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash"
          >Avery Cocozziello</a
        >
        on
        <a
          href="https://unsplash.com/photos/ocean-waves-crashing-on-shore-during-daytime-6EzEQUMF2h4?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash"
          >Unsplash</a
        >
      </footer>
    </div>
    <div class="right-section">
      <h1>Southern Oregon Rafting Forecast (SORF)</h1>
      <h3>Select a river on the map, or use the options on the right.</h3>

      <div class="map-form-container">
        <!--The map-->
        <div
          id="map"
          style="height: 350px; width: 60%; border: 5px solid #2e5b29"
        ></div>
        <script>
          let config = {
            minZoom: 1,
            maxZoom: 18,
          }

          // Map starting properties
          const zoom = 8
          const lat = 42.4
          const lng = -123.3

          // Initialize the map
          const map = L.map("map", config).setView([lat, lng], zoom)

          // Load tile layer with attribution
          L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png", {
            attribution:
              '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
          }).addTo(map)

          //Load custom icon
          var customIcon = L.icon({
            iconUrl:
              "https://raw.githubusercontent.com/nathang425/nathang425.github.io/refs/heads/main/images/favorites_circle03.png",
            iconSize: [20, 20], // Adjust size as needed
            iconAnchor: [0, 0], // Adjust anchor point
            popupAnchor: [5, -30], // Adjust popup position
          })

          // Load and fit KML layer
          var sorf_pts = omnivore
            .kml("kml/oregon_points.kml")
            .on("ready", function () {
              this.addTo(map)
              map.fitBounds(this.getBounds())
            })
            .on("layeradd", function (e) {
              if (e.layer instanceof L.Marker) {
                e.layer.setIcon(customIcon)
              }
              if (e.layer.feature && e.layer.feature.properties) {
                e.layer.bindPopup(
                  e.layer.feature.properties.name || "Unknown Name",
                )
              }
            })
        </script>

        <!--The form-->
        <form id="forecast_input">
          <h2>Options</h2>
          <label for="forecast_type">Forecast Type:</label><br />
          <select
            id="forecast_type"
            name="forecast_type"
            style="width: 100%; text-align: center"
          >
            <option value="short_range">
              Short Range: 18hrs (most accurate)
            </option>
            <option value="medium_range">
              Medium Range: 8-10d (mid accuracy)
            </option>
            <option value="long_range">
              Long Range: 30d (least accurate)
            </option></select
          ><br />
          <label for="river_station">Data Station:</label><br />
          <select
            id="river_station"
            name="river_station"
            style="width: 100%; text-align: left"
          >
            <option value="applegate_applegate">
              Applegate River near Applegate, OR
            </option>
            <option value="applegate_wilderville">
              Applegate River near Wilderville, OR
            </option>
            <option value="rogue_agness">Rogue River near Agness, OR</option>
            <option value="rogue_eaglepoint">
              Rogue River near Eagle Point, OR
            </option>
            <option value="rogue_grantspass">
              Rogue River at Grants Pass, OR
            </option>
            <option value="rogue_goldraydam">
              Rogue River below Gold Ray Dam, OR
            </option>
            <option value="umpqua_winchester">
              North Umpqua River near Winchester, OR
            </option>
            <option value="umpqua_roseburg">
              South Umpqua River at Roseburg, OR
            </option>
            <option value="umpqua_tiller">
              South Umpqua River near Tiller, OR
            </option>
            <option value="umpqua_winston">
              South Umpqua River near Winston, OR
            </option>
            <option value="umpqua_reedsport">
              Umpqua River at Reedsport, OR
            </option>
            <option value="umpqua_elkton">
              Umpqua River near Elkton, OR
            </option></select
          ><br />
          <button
            type="button"
            id="get_forecast"
            class="button"
            style="margin-top: 10px"
          >
            Get Forecast
          </button>
        </form>
      </div>

      <div class="graph-table-container">
        <!--Build the table-->
        <div id="table_container">
          <h3>Forecast</h3>
          <table id="forecast_table">
            <thead>
              <tr>
                <th>Time/Date</th>
                <th>Flow (cfs)</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <br />

        <!--Build the graph-->
        <div id="graph_container">
          <h3>Forecast Graph</h3>
          <canvas id="forecast_graph"></canvas>
        </div>
      </div>
      <p>
        Want to see
        <a href="https://nathang425.github.io/how_it_works">how it works?</a>
      </p>

      <footer>
        Icons made by
        <a
          href="https://www.flaticon.com/authors/bomsymbols"
          title="BomSymbols"
        >
          BomSymbols
        </a>
        from
        <a href="https://www.flaticon.com/" title="Flaticon"
          >www.flaticon.com
        </a>
      </footer>
    </div>
    <!--End right-section-->
    <script src="js/nwm_api.js"></script>
  </body>
</html>
